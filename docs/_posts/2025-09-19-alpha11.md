---
layout: post
title: pv 衍生数据
categories:
  - data
tags:
  - content
last_modified_at: 2026-01-06T04:31
created: 2025-09-19T21:56
---
## pv数据

| **0阶数据 (原始)**  | **一阶数据 (派生)**                                                                                                    | **二阶数据 (高阶特征 & 技术指标)**                                                                                                                                    | **三阶数据 (组合/因子)**                                                                   |
| -------------- | ---------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------- |
| **open**       |                                                                                                                  | **cumret**:`prod(1+returns)-1`<br>**excess_ret**:`returns - rf`<br>**fear**:`ts_mean(abs(returns - market_return)/(abs(returns)+abs(market_return)), 20)` | **liquidity-adjusted return**:`returns / (1+Illiquidity)`                          |
| **close**      | **returns**:`(close - close[-1]) / close[-1]`<br>---<br>**vwap**:`sum(close*volume)/sum(volume)`<br>             | **volatility**:`ts_std(returns, 20)`<br>**RSI** (relative strength index)<br>**MACD** (EMA_diff(close))<br>**ROC**:`(close_t/close_{t-n} - 1)`            | **risk-adjusted momentum**:`momentum / volatility`                                 |
| **high**       |                                                                                                                  | **maxdrawdown**:`(peak(close) - trough(close)) / peak(close)`<br>**Williams %R**:`(HH_n - close)/(HH_n-LL_n)`                                             | **volume-adjusted maxdrawdown**:`maxdrawdown / adv20`                              |
| **low**        | <br><br>                                                                                                         | **downside_vol**:`ts_std(min(returns,0),20)`<br>**Stochastic %K/%D**:`(close - LL_n)/(HH_n-LL_n)`                                                         | **reversal-risk**:`(-returns(1m)) / downside_vol`                                  |
| **volume**     | **adv20**:`ts_mean(volume, 20)`<br>**log_volume**:`log(volume)`<br>**volume_z**:`(volume - mean(volume,20))/std` | **Illiquidity**:`abs(returns) / volume`<br>**OBV** (on-balance volume)<br>**CMF** (Chaikin money flow)                                                    | **liquidity_momentum**:`momentum * (-Illiquidity)`                                 |
| **sharesout**  | **mkt_cap**:`close * sharesout`<br>**turnover**:`volume / sharesout`<br>**turn20**:`ts_mean(turnover, 20)`       | **size_effect**:`log(mkt_cap)`                                                                                                                            | **scaled_turnover**:`turnover / size_effect`                                       |
| **vwap**       |                                                                                                                  | **spread**:`(high - low)/vwap`<br>**Amihud illiq**:`ts_mean(abs(returns)/dollar_volume,20)`                                                               | **liquidity_volatility**:`volatility * Amihud_illiq`                               |
| **dollar_vol** | **dollar_volume**:`close * volume`                                                                               | **turnover_vol**:`ts_std(turnover,20)`                                                                                                                    | **volume_volatility_ratio**:`volatility / turnover_vol`                            |
| **ohlc**       | **hl_range**:`(high - low)/close`<br>**oc_gap/overnight return**:`(open - close[-1])/close[-1]`                  | **realized_vol**:`sqrt(sum(log(high/low)^2 + log(close/open)^2 ... over window))`                                                                         | **gap_volatility**:`oc_gap / realized_vol`                                         |
| **returns**    |                                                                                                                  | **momentum**:`ts_mean(returns, 12m)`<br>**reversal**:`-returns(1m)`                                                                                       | **momentum_reversal**:`momentum * reversal`**vol_mom**:`momentum * (1/volatility)` |


- rsv(未成熟随机值) = (close - ts_min(low, n)) / (ts_max(high, n) - ts_min(low, n)) n=9

对应关系
- cap = close x sharesout